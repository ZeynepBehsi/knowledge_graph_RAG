<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embeddings in RAG</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary:   #7c3aed;
            --secondary: #0ea5e9;
            --green:     #10b981;
            --orange:    #f59e0b;
            --red:       #ef4444;
            --dark:      #1e293b;
            --muted:     #64748b;
            --border:    #e2e8f0;
            --light:     #f8fafc;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.7;
            color: #334155;
            background: linear-gradient(135deg, #7c3aed 0%, #0ea5e9 100%);
            min-height: 100vh;
        }

        .container { max-width: 1100px; margin: 0 auto; padding: 24px; }

        /* â”€â”€ HEADER â”€â”€ */
        header {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 6px;
            background: linear-gradient(90deg, #7c3aed, #0ea5e9, #10b981);
        }
        h1 {
            font-size: 2.4em;
            background: linear-gradient(135deg, #7c3aed, #0ea5e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .subtitle { color: var(--muted); font-size: 1.05em; }

        /* â”€â”€ NAV â”€â”€ */
        .nav-tabs {
            display: flex; gap: 8px; flex-wrap: wrap;
            background: white; padding: 12px; border-radius: 14px;
            margin-bottom: 22px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }
        .tab-btn {
            flex: 1; min-width: 160px;
            padding: 12px 16px;
            background: #f1f5f9; color: #475569;
            border: 2px solid transparent; border-radius: 10px;
            cursor: pointer; font-size: 0.95em; font-weight: 600;
            transition: all 0.25s;
        }
        .tab-btn:hover { background: #ede9fe; color: #5b21b6; }
        .tab-btn.active {
            background: linear-gradient(135deg, #7c3aed, #0ea5e9);
            color: white;
            box-shadow: 0 4px 14px rgba(124,58,237,0.4);
        }

        /* â”€â”€ CONTENT â”€â”€ */
        .tab-pane {
            display: none;
            background: white; border-radius: 18px;
            padding: 44px; box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            animation: fadeUp 0.35s ease;
        }
        .tab-pane.active { display: block; }
        @keyframes fadeUp {
            from { opacity:0; transform:translateY(12px); }
            to   { opacity:1; transform:translateY(0); }
        }

        h2 { font-size: 1.8em; color: var(--dark); margin-bottom: 20px; }
        h3 { font-size: 1.25em; color: var(--primary); margin: 28px 0 12px; }
        h4 { font-size: 1.05em; color: var(--dark); margin: 16px 0 8px; }
        p  { margin-bottom: 12px; }

        /* â”€â”€ CALLOUT â”€â”€ */
        .callout {
            display: flex; gap: 14px; align-items: flex-start;
            padding: 18px; border-radius: 12px; margin: 16px 0;
        }
        .callout.purple { background: #f5f3ff; border: 1px solid #c4b5fd; }
        .callout.blue   { background: #eff6ff; border: 1px solid #93c5fd; }
        .callout.green  { background: #f0fdf4; border: 1px solid #86efac; }
        .callout.yellow { background: #fffbeb; border: 1px solid #fcd34d; }
        .callout-icon   { font-size: 1.5em; flex-shrink: 0; margin-top: 2px; }

        /* â”€â”€ CODE â”€â”€ */
        .code {
            background: #0f172a; color: #e2e8f0;
            padding: 18px 22px; border-radius: 10px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.88em; line-height: 1.75;
            overflow-x: auto; margin: 12px 0;
        }
        .kw  { color: #c792ea; font-weight: bold; }
        .st  { color: #c3e88d; }
        .cm  { color: #546e7a; font-style: italic; }
        .fn  { color: #82aaff; }
        .nb  { color: #f78c6c; }

        /* â”€â”€ VECTOR CANVAS â”€â”€ */
        .canvas-wrap {
            background: #f8fafc; border: 2px dashed #cbd5e1;
            border-radius: 14px; padding: 20px; margin: 20px 0;
            text-align: center;
        }
        canvas { border-radius: 10px; max-width: 100%; }

        /* â”€â”€ STEP FLOW â”€â”€ */
        .flow {
            display: flex; align-items: stretch;
            gap: 0; margin: 24px 0; flex-wrap: wrap;
        }
        .flow-node {
            flex: 1; min-width: 120px;
            padding: 16px 12px; text-align: center;
            border-radius: 12px; font-size: 0.88em;
            transition: transform 0.2s;
        }
        .flow-node:hover { transform: translateY(-4px); }
        .flow-arrow {
            display: flex; align-items: center;
            padding: 0 4px; color: #94a3b8; font-size: 1.4em;
            flex-shrink: 0;
        }

        /* â”€â”€ COMPARISON â”€â”€ */
        .compare {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 16px; margin: 20px 0;
        }
        .compare-card {
            border-radius: 12px; padding: 20px;
            border: 2px solid var(--border);
        }
        .compare-card h4 { margin-top: 0; }

        /* â”€â”€ TABLE â”€â”€ */
        .tbl { width:100%; border-collapse:collapse; margin:16px 0; border-radius:12px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.07); }
        .tbl th { background:linear-gradient(135deg,#7c3aed,#0ea5e9); color:white; padding:13px 16px; text-align:left; font-weight:600; }
        .tbl td { padding:12px 16px; border-bottom:1px solid #f1f5f9; }
        .tbl tr:hover td { background:#fafafa; }
        .tbl tr:last-child td { border-bottom:none; }

        /* â”€â”€ BADGE â”€â”€ */
        .badge { display:inline-block; padding:3px 10px; border-radius:20px; font-size:0.82em; font-weight:600; }
        .badge-purple { background:#ede9fe; color:#5b21b6; }
        .badge-blue   { background:#dbeafe; color:#1e40af; }
        .badge-green  { background:#dcfce7; color:#15803d; }

        /* â”€â”€ HIGHLIGHT â”€â”€ */
        .hl        { background:#fef9c3; padding:2px 6px; border-radius:4px; font-weight:600; color:#92400e; }
        .hl-purple { background:#ede9fe; padding:2px 6px; border-radius:4px; font-weight:600; color:#5b21b6; }
        .hl-blue   { background:#dbeafe; padding:2px 6px; border-radius:4px; font-weight:600; color:#1e40af; }
        .hl-green  { background:#dcfce7; padding:2px 6px; border-radius:4px; font-weight:600; color:#15803d; }

        /* â”€â”€ TIMELINE â”€â”€ */
        .timeline { position:relative; padding-left:32px; margin:20px 0; }
        .timeline::before {
            content:''; position:absolute; left:10px; top:0; bottom:0;
            width:3px; background:linear-gradient(180deg,#7c3aed,#0ea5e9,#10b981);
            border-radius:3px;
        }
        .tl-item { position:relative; margin-bottom:24px; }
        .tl-dot {
            position:absolute; left:-28px; top:4px;
            width:20px; height:20px; border-radius:50%;
            display:flex; align-items:center; justify-content:center;
            font-size:0.75em; font-weight:700; color:white;
        }
        .tl-card {
            border-radius:12px; padding:18px 20px;
            border: 2px solid var(--border);
            transition: all 0.2s;
        }
        .tl-card:hover { transform:translateX(4px); box-shadow:0 4px 12px rgba(0,0,0,0.08); }

        /* â”€â”€ KEY POINTS â”€â”€ */
        .kp { background:linear-gradient(135deg,#f5f3ff,#ede9fe); border-radius:14px; padding:22px; margin:22px 0; }
        .kp ul { list-style:none; }
        .kp li { padding:8px 0 8px 28px; position:relative; border-bottom:1px solid rgba(124,58,237,0.1); }
        .kp li:last-child { border-bottom:none; }
        .kp li::before { content:"âœ“"; position:absolute; left:0; color:#7c3aed; font-weight:bold; font-size:1.1em; }

        /* â”€â”€ INTERACTIVE DEMO â”€â”€ */
        .demo-box {
            background:linear-gradient(135deg,#fef3c7,#fde68a);
            border-radius:14px; padding:26px; margin:22px 0; text-align:center;
        }
        .demo-btn {
            background:linear-gradient(135deg,#7c3aed,#0ea5e9);
            color:white; padding:10px 22px; border:none; border-radius:8px;
            cursor:pointer; font-size:0.93em; font-weight:600; margin:6px;
            transition:all 0.25s;
        }
        .demo-btn:hover { transform:scale(1.05); box-shadow:0 4px 14px rgba(124,58,237,0.4); }
        .demo-result {
            background:white; border-radius:10px; padding:16px;
            margin-top:14px; display:none; text-align:left;
            animation: fadeUp 0.3s ease;
        }

        /* â”€â”€ SIMILARITY BAR â”€â”€ */
        .sim-row { display:flex; align-items:center; gap:12px; margin:8px 0; font-size:0.9em; }
        .sim-label { min-width:220px; }
        .sim-bar-wrap { flex:1; background:#f1f5f9; border-radius:20px; height:18px; overflow:hidden; }
        .sim-bar { height:100%; border-radius:20px; transition:width 1s ease; }
        .sim-score { min-width:40px; font-weight:700; text-align:right; }

        footer {
            background:white; border-radius:14px; padding:24px;
            margin-top:24px; text-align:center;
            box-shadow:0 -4px 20px rgba(0,0,0,0.07);
        }

        @media(max-width:680px){
            .compare { grid-template-columns:1fr; }
            .flow { flex-direction:column; }
            .flow-arrow { transform:rotate(90deg); align-self:center; }
            .tab-pane { padding:24px; }
            h1 { font-size:1.7em; }
        }
    </style>
</head>
<body>
<div class="container">

    <!-- HEADER -->
    <header>
        <h1>ğŸ”¢ Embeddings in RAG</h1>
        <p class="subtitle">Metni sayÄ±ya Ã§evirmek â€” ve bunun RAG'Ä± neden mÃ¼mkÃ¼n kÄ±ldÄ±ÄŸÄ±</p>
    </header>

    <!-- NAV -->
    <nav class="nav-tabs">
        <button class="tab-btn active" onclick="openTab('t1',this)">1 â€” Embedding Nedir?</button>
        <button class="tab-btn"        onclick="openTab('t2',this)">2 â€” Benzerlik NasÄ±l Ã–lÃ§Ã¼lÃ¼r?</button>
        <button class="tab-btn"        onclick="openTab('t3',this)">3 â€” RAG'da KaÃ§ Kez?</button>
        <button class="tab-btn"        onclick="openTab('t4',this)">4 â€” Bu Projede</button>
    </nav>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TAB 1 â€” Embedding Nedir?
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="t1" class="tab-pane active">
        <h2>Embedding Nedir?</h2>

        <div class="callout purple">
            <div class="callout-icon">ğŸ’¡</div>
            <div>
                <strong>Tek cÃ¼mleyle:</strong> Embedding, bir metni bilgisayarÄ±n
                <em>anlamÄ±nÄ± anlayabileceÄŸi</em> bir sayÄ± dizisine Ã§evirmektir.
            </div>
        </div>

        <!-- Sezgi: Kelimeler â†’ koordinatlar -->
        <h3>Sezgi: Kelimeler Uzayda Bir Yerde</h3>
        <p>
            Her metni bir <strong>noktaya</strong> dÃ¶nÃ¼ÅŸtÃ¼rdÃ¼ÄŸÃ¼nÃ¼ hayal et.
            Anlamca benzer metinler o uzayda <em>birbirine yakÄ±n</em> noktalara dÃ¼ÅŸer.
        </p>

        <div class="canvas-wrap">
            <p style="color:var(--muted);font-size:0.85em;margin-bottom:12px;">
                GerÃ§ekte 1536 boyut vardÄ±r â€” aÅŸaÄŸÄ±da 2 boyuta indirgenmiÅŸ hali:
            </p>
            <canvas id="vecCanvas" width="600" height="340"></canvas>
            <p style="color:var(--muted);font-size:0.82em;margin-top:10px;">
                Noktalara fareyle yaklaÅŸ â†’
            </p>
        </div>

        <!-- GerÃ§ek vektÃ¶r -->
        <h3>GerÃ§ekte NasÄ±l GÃ¶rÃ¼nÃ¼r?</h3>
        <p>
            OpenAI'nin <code>text-embedding-ada-002</code> modeli her metni
            <span class="hl">1536 sayÄ±lÄ±k bir dizi</span>e Ã§evirir:
        </p>
        <div class="code">
<span class="cm"># "A love story" metninin embedding'i (ilk 10 sayÄ±)</span>
[<span class="nb"> 0.0174</span>, <span class="nb">-0.0054</span>, <span class="nb">-0.0020</span>, <span class="nb">-0.0255</span>, <span class="nb">-0.0144</span>,
 <span class="nb"> 0.0167</span>, <span class="nb">-0.0170</span>, <span class="nb"> 0.0004</span>, <span class="nb">-0.0252</span>, <span class="nb">-0.0295</span>,
 <span class="cm"> ... (toplamda 1536 sayÄ±)</span> ]
        </div>
        <p>
            Bu sayÄ±larÄ±n tek tek anlamÄ± yoktur.
            Ã–nemli olan, <strong>iki metnin sayÄ± dizileri arasÄ±ndaki mesafe</strong>dir.
        </p>

        <!-- Kural: yakÄ±n = benzer -->
        <h3>Temel Kural</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin:16px 0;">
            <div style="background:#f0fdf4;border:2px solid #86efac;border-radius:12px;padding:18px;text-align:center;">
                <div style="font-size:2em;margin-bottom:8px;">ğŸŸ¢</div>
                <strong>VektÃ¶rler yakÄ±nsa</strong>
                <p style="font-size:0.88em;margin-top:6px;color:var(--muted);">Metinler anlamca benzerdir</p>
                <div style="font-size:0.82em;margin-top:8px;background:white;border-radius:8px;padding:8px;">
                    "A love story"<br>â‰ˆ<br>"Bir aÅŸk hikayesi"
                </div>
            </div>
            <div style="background:#fef9c3;border:2px solid #fde68a;border-radius:12px;padding:18px;text-align:center;">
                <div style="font-size:2em;margin-bottom:8px;">ğŸ“</div>
                <strong>Mesafe = Anlam farkÄ±</strong>
                <p style="font-size:0.88em;margin-top:6px;color:var(--muted);">Cosine similarity ile Ã¶lÃ§Ã¼lÃ¼r</p>
                <div style="font-size:0.82em;margin-top:8px;background:white;border-radius:8px;padding:8px;">
                    0.0 â†’ tamamen farklÄ±<br>
                    1.0 â†’ aynÄ± anlam
                </div>
            </div>
            <div style="background:#eff6ff;border:2px solid #93c5fd;border-radius:12px;padding:18px;text-align:center;">
                <div style="font-size:2em;margin-bottom:8px;">ğŸ”´</div>
                <strong>VektÃ¶rler uzaksa</strong>
                <p style="font-size:0.88em;margin-top:6px;color:var(--muted);">Metinler anlamca farklÄ±dÄ±r</p>
                <div style="font-size:0.82em;margin-top:8px;background:white;border-radius:8px;padding:8px;">
                    "A love story"<br>â‰ <br>"Quantum physics"
                </div>
            </div>
        </div>

        <!-- Neden RAG iÃ§in ÅŸart? -->
        <h3>Neden RAG Ä°Ã§in Åart?</h3>
        <div class="callout yellow">
            <div class="callout-icon">âš ï¸</div>
            <div>
                <strong>Geleneksel arama</strong>, metni olduÄŸu gibi karÅŸÄ±laÅŸtÄ±rÄ±r.
                "love" ile "aÅŸk" eÅŸleÅŸmez, "romantic" ile "love" de eÅŸleÅŸmez.
                Embedding sayesinde bu kÄ±sÄ±tlama ortadan kalkar â€” kelimeler deÄŸil,
                <em>anlamlar</em> karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.
            </div>
        </div>

        <table class="tbl">
            <thead>
                <tr><th>YÃ¶ntem</th><th>Soru: "love movies"</th><th>Bulabilir mi?</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td>Kelime eÅŸleÅŸmesi</td>
                    <td>"A story of <strong>love</strong> and passion" sloganÄ±</td>
                    <td style="color:var(--green);">âœ“ Evet â€” "love" kelimesi var</td>
                </tr>
                <tr>
                    <td>Kelime eÅŸleÅŸmesi</td>
                    <td>"First loves last. Forever." sloganÄ±</td>
                    <td style="color:var(--green);">âœ“ Evet â€” "loves" var</td>
                </tr>
                <tr>
                    <td>Kelime eÅŸleÅŸmesi</td>
                    <td>"Can two friends sleep together and still love each other?" </td>
                    <td style="color:var(--green);">âœ“ Evet</td>
                </tr>
                <tr style="background:#fff7ed;">
                    <td>Kelime eÅŸleÅŸmesi</td>
                    <td>"You will laugh, you will cry, you will be moved."</td>
                    <td style="color:var(--red);">âœ— HayÄ±r â€” "love" yok</td>
                </tr>
                <tr style="background:#f0fdf4;">
                    <td><strong>Embedding aramasÄ±</strong></td>
                    <td>"You will laugh, you will cry, you will be moved."</td>
                    <td style="color:var(--green);">âœ“ Evet â€” anlam yakÄ±n</td>
                </tr>
            </tbody>
        </table>

        <div class="kp">
            <h4>Ã–zet</h4>
            <ul>
                <li>Embedding = metin â†’ sayÄ± dizisi (1536 boyut)</li>
                <li>Benzer anlamlÄ± metinler, vektÃ¶r uzayÄ±nda birbirine yakÄ±ndÄ±r</li>
                <li>Mesafe cosine similarity ile Ã¶lÃ§Ã¼lÃ¼r: 0 (farklÄ±) â†’ 1 (aynÄ±)</li>
                <li>RAG'Ä±n "doÄŸru chunk'Ä± bulma" adÄ±mÄ± tamamen embedding'e dayanÄ±r</li>
            </ul>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TAB 2 â€” Benzerlik NasÄ±l Ã–lÃ§Ã¼lÃ¼r?
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="t2" class="tab-pane">
        <h2>Benzerlik NasÄ±l Ã–lÃ§Ã¼lÃ¼r?</h2>

        <div class="callout blue">
            <div class="callout-icon">ğŸ“</div>
            <div>
                Ä°ki vektÃ¶rÃ¼n benzerliÄŸini Ã¶lÃ§mek iÃ§in <strong>Cosine Similarity</strong>
                kullanÄ±lÄ±r. Ä°ki vektÃ¶r arasÄ±ndaki <em>aÃ§Ä±ya</em> bakar â€” uzunluÄŸa deÄŸil.
            </div>
        </div>

        <!-- Sezgi: aÃ§Ä± -->
        <h3>Sezgi: AÃ§Ä± KÃ¼Ã§Ã¼ldÃ¼kÃ§e Benzerlik Artar</h3>

        <div class="canvas-wrap">
            <canvas id="cosCanvas" width="560" height="300"></canvas>
            <p style="color:var(--muted);font-size:0.82em;margin-top:10px;">
                VektÃ¶rler aynÄ± yÃ¶ne iÅŸaret ediyorsa (aÃ§Ä± â‰ˆ 0Â°) â†’ benzerlik â‰ˆ 1.0
            </p>
        </div>

        <!-- FormÃ¼l -->
        <h3>FormÃ¼l (basit hali)</h3>
        <div style="background:#f8fafc;border-radius:12px;padding:22px;text-align:center;margin:16px 0;border:2px solid var(--border);">
            <div style="font-size:1.3em;font-weight:700;color:var(--primary);letter-spacing:0.02em;">
                cosine_similarity(A, B) = cos(Î¸)
            </div>
            <div style="margin-top:12px;color:var(--muted);font-size:0.9em;">
                Î¸ â†’ iki vektÃ¶r arasÄ±ndaki aÃ§Ä±<br>
                SonuÃ§: <strong>âˆ’1</strong> (zÄ±t anlam) &nbsp;â†’&nbsp; <strong>0</strong> (ilgisiz) &nbsp;â†’&nbsp; <strong>1</strong> (aynÄ± anlam)
            </div>
        </div>

        <!-- GerÃ§ek skorlar -->
        <h3>GerÃ§ek Proje SonuÃ§larÄ± â€” "What movies are about love?"</h3>
        <p>Her filmin sloganÄ± embedding'e Ã§evrilmiÅŸ ve soru vektÃ¶rÃ¼yle karÅŸÄ±laÅŸtÄ±rÄ±lmÄ±ÅŸ:</p>

        <div id="simBars" style="margin:20px 0;"></div>

        <button class="demo-btn" onclick="animateBars()" style="display:block;margin:0 auto;">
            SkorlarÄ± GÃ¶ster
        </button>

        <!-- Skor yorumu -->
        <h3>Skor Ne Anlama Gelir?</h3>
        <table class="tbl">
            <thead><tr><th>Skor AralÄ±ÄŸÄ±</th><th>Anlam</th><th>Ã–rnek</th></tr></thead>
            <tbody>
                <tr>
                    <td><span style="color:var(--green);font-weight:700;">0.90 â€“ 1.00</span></td>
                    <td>Ã‡ok gÃ¼Ã§lÃ¼ benzerlik</td>
                    <td>"love story" â†” "love story"</td>
                </tr>
                <tr>
                    <td><span style="color:#84cc16;font-weight:700;">0.80 â€“ 0.90</span></td>
                    <td>GÃ¼Ã§lÃ¼ benzerlik</td>
                    <td>"love movies" â†” "romance film"</td>
                </tr>
                <tr>
                    <td><span style="color:var(--orange);font-weight:700;">0.65 â€“ 0.80</span></td>
                    <td>Orta benzerlik</td>
                    <td>"love" â†” "human relationships"</td>
                </tr>
                <tr>
                    <td><span style="color:var(--red);font-weight:700;">0.00 â€“ 0.65</span></td>
                    <td>ZayÄ±f / ilgisiz</td>
                    <td>"love movies" â†” "quantum physics"</td>
                </tr>
            </tbody>
        </table>

        <div class="callout green">
            <div class="callout-icon">âœ…</div>
            <div>
                RAG'da genellikle <strong>top-5</strong> veya <strong>top-10</strong> en yÃ¼ksek
                skorlu chunk seÃ§ilir ve LLM'e gÃ¶nderilir. EÅŸik deÄŸeri yoktur â€”
                en yakÄ±n olanlar kazanÄ±r.
            </div>
        </div>

        <div class="kp">
            <h4>Ã–zet</h4>
            <ul>
                <li>Cosine similarity iki vektÃ¶r arasÄ±ndaki aÃ§Ä±yÄ± Ã¶lÃ§er</li>
                <li>0.90+ = Ã§ok benzer, 0.65 altÄ± = ilgisiz kabul edilir</li>
                <li>RAG'da top-K en benzer chunk'lar seÃ§ilir</li>
                <li>Kelimeler eÅŸleÅŸmese de anlam benzerliÄŸi yakalanÄ±r</li>
            </ul>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TAB 3 â€” RAG'da KaÃ§ Kez?
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="t3" class="tab-pane">
        <h2>RAG'da Embedding KaÃ§ Kez YapÄ±lÄ±r?</h2>

        <div class="callout purple">
            <div class="callout-icon">ğŸ”¢</div>
            <div>
                Bu projede embedding <strong>3 farklÄ± anda</strong> yapÄ±lÄ±r.
                Ä°kisi hazÄ±rlÄ±k aÅŸamasÄ±nda <em>bir kez</em>, biri sorgulama aÅŸamasÄ±nda
                <em>her soruda</em> tekrar eder.
            </div>
        </div>

        <h3>Genel Åema</h3>

        <!-- Ä°ki aÅŸama yan yana -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:20px 0;">

            <!-- HazÄ±rlÄ±k -->
            <div style="background:#f5f3ff;border:2px solid #c4b5fd;border-radius:14px;padding:22px;">
                <div style="font-weight:700;color:#5b21b6;font-size:1.05em;margin-bottom:16px;text-align:center;">
                    ğŸ“¦ HAZIRLIK AÅAMASI<br>
                    <span style="font-weight:400;font-size:0.85em;color:var(--muted);">Bir kez Ã§alÄ±ÅŸÄ±r, sonuÃ§ saklanÄ±r</span>
                </div>

                <div style="display:flex;flex-direction:column;gap:10px;">
                    <!-- Op 1 -->
                    <div style="background:white;border-radius:10px;padding:14px;border:1px solid #ddd6fe;">
                        <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;">
                            <span style="background:#7c3aed;color:white;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-size:0.8em;font-weight:700;flex-shrink:0;">1</span>
                            <strong style="font-size:0.92em;">Film tagline'larÄ±nÄ± embed et</strong>
                        </div>
                        <div style="font-size:0.84em;color:var(--muted);padding-left:32px;">
                            38 film Ã— 1 slogan<br>
                            â†’ <code>taglineEmbedding</code> property
                        </div>
                    </div>
                    <!-- Op 2 -->
                    <div style="background:white;border-radius:10px;padding:14px;border:1px solid #ddd6fe;">
                        <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;">
                            <span style="background:#0ea5e9;color:white;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-size:0.8em;font-weight:700;flex-shrink:0;">2</span>
                            <strong style="font-size:0.92em;">Chunk metinlerini embed et</strong>
                        </div>
                        <div style="font-size:0.84em;color:var(--muted);padding-left:32px;">
                            80 chunk Ã— 1 metin<br>
                            â†’ <code>textEmbedding</code> property
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sorgulama -->
            <div style="background:#f0fdf4;border:2px solid #86efac;border-radius:14px;padding:22px;">
                <div style="font-weight:700;color:#15803d;font-size:1.05em;margin-bottom:16px;text-align:center;">
                    ğŸ’¬ SORGULAMA AÅAMASI<br>
                    <span style="font-weight:400;font-size:0.85em;color:var(--muted);">Her soruda tekrar eder</span>
                </div>

                <div style="display:flex;flex-direction:column;gap:10px;">
                    <!-- Op 3 -->
                    <div style="background:white;border-radius:10px;padding:14px;border:1px solid #86efac;">
                        <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;">
                            <span style="background:#10b981;color:white;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-size:0.8em;font-weight:700;flex-shrink:0;">3</span>
                            <strong style="font-size:0.92em;">Soruyu embed et</strong>
                        </div>
                        <div style="font-size:0.84em;color:var(--muted);padding-left:32px;">
                            1 soru â†’ 1 vektÃ¶r<br>
                            â†’ HazÄ±rlÄ±k vektÃ¶rleriyle karÅŸÄ±laÅŸtÄ±r<br>
                            â†’ En benzer chunk'larÄ± getir
                        </div>
                    </div>
                    <div style="background:#dcfce7;border-radius:10px;padding:12px;font-size:0.84em;color:#15803d;text-align:center;">
                        Bu adÄ±m <strong>her yeni soru</strong>da tekrar Ã§alÄ±ÅŸÄ±r.<br>
                        HazÄ±rlÄ±k adÄ±mlarÄ± Ã§alÄ±ÅŸmaz â€” sonuÃ§lar zaten Neo4j'de saklÄ±.
                    </div>
                </div>
            </div>
        </div>

        <!-- AkÄ±ÅŸ animasyonu -->
        <h3>AdÄ±m AdÄ±m AkÄ±ÅŸ</h3>

        <div class="timeline">
            <div class="tl-item">
                <div class="tl-dot" style="background:#7c3aed;">1</div>
                <div class="tl-card" style="border-color:#ddd6fe;background:#faf5ff;">
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px;">
                        <div>
                            <strong>HazÄ±rlÄ±k Op. 1 â€” Tagline Embedding</strong>
                            <span class="badge badge-purple" style="margin-left:8px;">Notebook 2</span>
                        </div>
                        <span style="font-size:0.8em;color:var(--muted);">Bir kez Ã§alÄ±ÅŸÄ±r</span>
                    </div>
                    <div class="code" style="margin-top:12px;font-size:0.83em;">
<span class="cm"># Her Movie node iÃ§in</span>
<span class="kw">WITH</span> movie, genai.vector.encode(
    movie.tagline, <span class="st">"OpenAI"</span>, {token: ...}
) <span class="kw">AS</span> vector
<span class="kw">CALL</span> db.create.setNodeVectorProperty(
    movie, <span class="st">"taglineEmbedding"</span>, vector)
                    </div>
                    <div style="font-size:0.86em;color:var(--muted);margin-top:8px;">
                        SonuÃ§: Her <code>:Movie</code> node'unda <code>taglineEmbedding</code> property oluÅŸur.
                    </div>
                </div>
            </div>

            <div class="tl-item">
                <div class="tl-dot" style="background:#0ea5e9;">2</div>
                <div class="tl-card" style="border-color:#bae6fd;background:#f0f9ff;">
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px;">
                        <div>
                            <strong>HazÄ±rlÄ±k Op. 2 â€” Chunk Embedding</strong>
                            <span class="badge badge-blue" style="margin-left:8px;">Notebook 3</span>
                        </div>
                        <span style="font-size:0.8em;color:var(--muted);">Bir kez Ã§alÄ±ÅŸÄ±r</span>
                    </div>
                    <div class="code" style="margin-top:12px;font-size:0.83em;">
<span class="cm"># Her Chunk node iÃ§in</span>
<span class="kw">MATCH</span> (chunk:Chunk) <span class="kw">WHERE</span> chunk.textEmbedding <span class="kw">IS NULL</span>
<span class="kw">WITH</span> chunk, genai.vector.encode(
    chunk.text, <span class="st">"OpenAI"</span>, {token: ...}
) <span class="kw">AS</span> vector
<span class="kw">CALL</span> db.create.setNodeVectorProperty(
    chunk, <span class="st">"textEmbedding"</span>, vector)
                    </div>
                    <div style="font-size:0.86em;color:var(--muted);margin-top:8px;">
                        SonuÃ§: Her <code>:Chunk</code> node'unda <code>textEmbedding</code> property oluÅŸur.
                    </div>
                </div>
            </div>

            <div class="tl-item">
                <div class="tl-dot" style="background:#10b981;">3</div>
                <div class="tl-card" style="border-color:#86efac;background:#f0fdf4;">
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px;">
                        <div>
                            <strong>Sorgu Op. 3 â€” Soru Embedding</strong>
                            <span class="badge badge-green" style="margin-left:8px;">Her soruda</span>
                        </div>
                        <span style="font-size:0.8em;color:var(--muted);">Tekrar eder</span>
                    </div>
                    <div class="code" style="margin-top:12px;font-size:0.83em;">
<span class="cm"># NB2: Neo4j iÃ§inde doÄŸrudan</span>
<span class="kw">WITH</span> genai.vector.encode(
    $question, <span class="st">"OpenAI"</span>, {token: ...}
) <span class="kw">AS</span> question_embedding

<span class="cm"># NB3: LangChain Ã¼zerinden</span>
<span class="fn">OpenAIEmbeddings</span>().<span class="fn">embed_query</span>(question)
                    </div>
                    <div style="font-size:0.86em;color:var(--muted);margin-top:8px;">
                        SonuÃ§: Soru vektÃ¶rÃ¼, hazÄ±rlÄ±k vektÃ¶rleriyle cosine similarity hesaplanÄ±r â†’
                        en yakÄ±n K node dÃ¶ner.
                    </div>
                </div>
            </div>
        </div>

        <div class="kp">
            <h4>Ã–zet</h4>
            <ul>
                <li>Toplam 3 embedding operasyonu, 2 farklÄ± zamanda</li>
                <li>HazÄ±rlÄ±k (Op.1 + Op.2) bir kez Ã§alÄ±ÅŸÄ±r â€” sonuÃ§lar Neo4j'de kalÄ±r</li>
                <li>Sorgu (Op.3) her kullanÄ±cÄ± sorusunda tekrar eder</li>
                <li>Op.3'Ã¼n vektÃ¶rÃ¼, Op.1 veya Op.2'nin vektÃ¶rleriyle karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r</li>
            </ul>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TAB 4 â€” Bu Projede
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="t4" class="tab-pane">
        <h2>Bu Projede â€” taglineEmbedding vs textEmbedding</h2>

        <div class="callout yellow">
            <div class="callout-icon">âš ï¸</div>
            <div>
                <strong>Kafan karÄ±ÅŸmasÄ±n:</strong> <code>taglineEmbedding</code> ve
                <code>textEmbedding</code> aynÄ± ÅŸeydir â€”
                ikisi de bir metnin 1536 boyutlu vektÃ¶rÃ¼.
                Fark sadece <em>hangi node'da</em> ve <em>hangi metin iÃ§in</em> hesaplandÄ±ÄŸÄ±nda.
            </div>
        </div>

        <!-- KarÅŸÄ±laÅŸtÄ±rma tablosu -->
        <h3>KarÅŸÄ±laÅŸtÄ±rma</h3>
        <table class="tbl">
            <thead>
                <tr>
                    <th>Ã–zellik</th>
                    <th>taglineEmbedding</th>
                    <th>textEmbedding</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Hangi node</strong></td>
                    <td><code>:Movie</code></td>
                    <td><code>:Chunk</code></td>
                </tr>
                <tr>
                    <td><strong>Hangi metin</strong></td>
                    <td>Film sloganÄ± (kÄ±sa, ~10 kelime)</td>
                    <td>Belge parÃ§asÄ± (~2000 karakter)</td>
                </tr>
                <tr>
                    <td><strong>Hangi notebook</strong></td>
                    <td>Notebook 2</td>
                    <td>Notebook 3</td>
                </tr>
                <tr>
                    <td><strong>Ne amaÃ§la</strong></td>
                    <td>Film Ã¶nerisi (film arama)</td>
                    <td>RAG soru-cevap (belge arama)</td>
                </tr>
                <tr>
                    <td><strong>Boyut</strong></td>
                    <td>1536</td>
                    <td>1536</td>
                </tr>
                <tr>
                    <td><strong>Model</strong></td>
                    <td>OpenAI (text-embedding-ada-002)</td>
                    <td>OpenAI (text-embedding-ada-002)</td>
                </tr>
                <tr>
                    <td><strong>Vector index adÄ±</strong></td>
                    <td><code>movie_tagline_embeddings</code></td>
                    <td><code>form_10k_chunks</code></td>
                </tr>
            </tbody>
        </table>

        <!-- Yan yana gÃ¶rsel -->
        <h3>Neo4j'de NasÄ±l GÃ¶rÃ¼nÃ¼r?</h3>

        <div class="compare">
            <!-- Movie node -->
            <div style="border:2px solid #ddd6fe;border-radius:14px;overflow:hidden;">
                <div style="background:linear-gradient(135deg,#7c3aed,#5b21b6);color:white;padding:14px 18px;font-weight:700;">
                    :Movie node
                </div>
                <div style="padding:16px;font-size:0.88em;">
                    <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #f1f5f9;">
                        <span style="color:var(--muted);">title</span>
                        <span>"Joe Versus the Volcano"</span>
                    </div>
                    <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #f1f5f9;">
                        <span style="color:var(--muted);">tagline</span>
                        <span style="max-width:180px;text-align:right;">"A story of love, lava and burning desire."</span>
                    </div>
                    <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #f1f5f9;">
                        <span style="color:var(--muted);">released</span>
                        <span>1990</span>
                    </div>
                    <div style="padding:8px 0;">
                        <span style="color:var(--muted);">taglineEmbedding</span>
                        <div style="background:#0f172a;color:#c3e88d;border-radius:6px;padding:8px;margin-top:6px;font-family:monospace;font-size:0.82em;">
                            [0.017, -0.005, 0.023,<br>
                            -0.014, 0.031, ...<br>
                            <span style="color:#546e7a;">/* 1536 sayÄ± */</span>]
                        </div>
                    </div>
                    <div style="background:#f5f3ff;border-radius:8px;padding:10px;margin-top:8px;font-size:0.84em;color:#5b21b6;">
                        Bu vektÃ¶r, "What movies are about love?" sorusunun vektÃ¶rÃ¼yle karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.
                    </div>
                </div>
            </div>

            <!-- Chunk node -->
            <div style="border:2px solid #bae6fd;border-radius:14px;overflow:hidden;">
                <div style="background:linear-gradient(135deg,#0ea5e9,#0369a1);color:white;padding:14px 18px;font-weight:700;">
                    :Chunk node
                </div>
                <div style="padding:16px;font-size:0.88em;">
                    <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #f1f5f9;">
                        <span style="color:var(--muted);">chunkId</span>
                        <span style="font-size:0.82em;">...item1-chunk0001</span>
                    </div>
                    <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #f1f5f9;">
                        <span style="color:var(--muted);">f10kItem</span>
                        <span>item1</span>
                    </div>
                    <div style="padding:6px 0;border-bottom:1px solid #f1f5f9;">
                        <span style="color:var(--muted);">text</span>
                        <div style="font-size:0.82em;margin-top:4px;color:#334155;">"NetApp is a global cloud-led, data-centric software company..."</div>
                    </div>
                    <div style="padding:8px 0;">
                        <span style="color:var(--muted);">textEmbedding</span>
                        <div style="background:#0f172a;color:#c3e88d;border-radius:6px;padding:8px;margin-top:6px;font-family:monospace;font-size:0.82em;">
                            [0.031, -0.012, 0.008,<br>
                            0.044, -0.021, ...<br>
                            <span style="color:#546e7a;">/* 1536 sayÄ± */</span>]
                        </div>
                    </div>
                    <div style="background:#eff6ff;border-radius:8px;padding:10px;margin-top:8px;font-size:0.84em;color:#1e40af;">
                        Bu vektÃ¶r, "NetApp nedir?" sorusunun vektÃ¶rÃ¼yle karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.
                    </div>
                </div>
            </div>
        </div>

        <!-- Interaktif: sorgu simÃ¼lasyonu -->
        <h3>Sorgu SÄ±rasÄ±nda Ne Olur?</h3>

        <div class="demo-box">
            <p style="margin-bottom:14px;font-weight:600;">Bir soru seÃ§ â€” embedding akÄ±ÅŸÄ±nÄ± izle:</p>
            <button class="demo-btn" onclick="showQueryFlow('love')">Film: AÅŸk sorusu</button>
            <button class="demo-btn" onclick="showQueryFlow('netapp')">Belge: NetApp sorusu</button>
            <button class="demo-btn" onclick="showQueryFlow('apple')">Belge: Apple sorusu</button>
            <div id="query-flow-result" class="demo-result"></div>
        </div>

        <!-- Son bÃ¼yÃ¼k resim -->
        <h3>BÃ¼yÃ¼k Resim â€” Hepsi Bir Arada</h3>

        <div style="background:#f8fafc;border:2px dashed #cbd5e1;border-radius:14px;padding:24px;margin:20px 0;">
            <div style="display:flex;flex-direction:column;gap:8px;">

                <!-- SatÄ±r: Op 1 -->
                <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                    <div style="background:#7c3aed;color:white;border-radius:8px;padding:6px 14px;font-size:0.84em;font-weight:700;flex-shrink:0;">Op 1</div>
                    <div style="flex:1;min-width:200px;background:#faf5ff;border:1px solid #ddd6fe;border-radius:8px;padding:10px 14px;font-size:0.86em;">
                        <strong>Movie.tagline</strong> (kÄ±sa metin)
                        <span style="color:var(--muted);margin-left:6px;">38 kez</span>
                    </div>
                    <div style="color:var(--muted);font-size:1.2em;">â†’</div>
                    <div style="flex:1;min-width:200px;background:#0f172a;color:#c3e88d;border-radius:8px;padding:10px 14px;font-family:monospace;font-size:0.82em;">
                        taglineEmbedding [1536]
                    </div>
                    <div style="color:var(--muted);font-size:1.2em;">â†’</div>
                    <div style="flex:1;min-width:180px;background:#f5f3ff;border:1px solid #c4b5fd;border-radius:8px;padding:10px 14px;font-size:0.84em;">
                        movie_tagline_embeddings index
                    </div>
                </div>

                <!-- SatÄ±r: Op 2 -->
                <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                    <div style="background:#0ea5e9;color:white;border-radius:8px;padding:6px 14px;font-size:0.84em;font-weight:700;flex-shrink:0;">Op 2</div>
                    <div style="flex:1;min-width:200px;background:#f0f9ff;border:1px solid #bae6fd;border-radius:8px;padding:10px 14px;font-size:0.86em;">
                        <strong>Chunk.text</strong> (uzun metin)
                        <span style="color:var(--muted);margin-left:6px;">80 kez</span>
                    </div>
                    <div style="color:var(--muted);font-size:1.2em;">â†’</div>
                    <div style="flex:1;min-width:200px;background:#0f172a;color:#c3e88d;border-radius:8px;padding:10px 14px;font-family:monospace;font-size:0.82em;">
                        textEmbedding [1536]
                    </div>
                    <div style="color:var(--muted);font-size:1.2em;">â†’</div>
                    <div style="flex:1;min-width:180px;background:#eff6ff;border:1px solid #93c5fd;border-radius:8px;padding:10px 14px;font-size:0.84em;">
                        form_10k_chunks index
                    </div>
                </div>

                <!-- SatÄ±r: Op 3 -->
                <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                    <div style="background:#10b981;color:white;border-radius:8px;padding:6px 14px;font-size:0.84em;font-weight:700;flex-shrink:0;">Op 3</div>
                    <div style="flex:1;min-width:200px;background:#f0fdf4;border:1px solid #86efac;border-radius:8px;padding:10px 14px;font-size:0.86em;">
                        <strong>Kullanici sorusu</strong>
                        <span style="color:var(--muted);margin-left:6px;">her soruda</span>
                    </div>
                    <div style="color:var(--muted);font-size:1.2em;">â†’</div>
                    <div style="flex:1;min-width:200px;background:#0f172a;color:#c3e88d;border-radius:8px;padding:10px 14px;font-family:monospace;font-size:0.82em;">
                        question_embedding [1536]
                    </div>
                    <div style="color:var(--muted);font-size:1.2em;">â†’</div>
                    <div style="flex:1;min-width:180px;background:#f0fdf4;border:2px solid #4ade80;border-radius:8px;padding:10px 14px;font-size:0.84em;font-weight:600;color:#15803d;">
                        Op1 veya Op2 ile karsilastir<br>â†’ Top-K sonuc
                    </div>
                </div>

            </div>
        </div>

        <div class="kp">
            <h4>Her Seyi Unutsan Bu Kalsin</h4>
            <ul>
                <li><code>taglineEmbedding</code> ve <code>textEmbedding</code> aynÄ± sey â€” sadece property adÄ± ve node tipi farklÄ±</li>
                <li>HazÄ±rlÄ±k embedding'leri bir kez hesaplanÄ±r, Neo4j'de saklanÄ±r â€” her soruda yeniden hesaplanmaz</li>
                <li>Sorgulama embedding'i (Op.3) her soruda hesaplanÄ±r ve saklanan vektÃ¶rlerle karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r</li>
                <li>Op.3 hangi index'e soruyorsa (tagline mi, text mi), o hazÄ±rlÄ±k embedding'leriyle karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r</li>
            </ul>
        </div>
    </div>

    <footer>
        <p style="font-size:1em;margin-bottom:6px;"><strong>ğŸ”¢ Embeddings in RAG â€” Ã–ÄŸrenme ModÃ¼lÃ¼</strong></p>
        <p style="color:var(--muted);font-size:0.88em;">
            Kaynak: Lecture_notebooks/2-prep_text_for_RAG.ipynb &amp; 3-construct_kg_from_text.ipynb
        </p>
    </footer>

</div>

<script>
/* â”€â”€ TAB â”€â”€ */
function openTab(id, btn) {
    document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    btn.classList.add('active');
    window.scrollTo({top:0, behavior:'smooth'});
    if (id === 't2') setTimeout(drawCosine, 100);
}

/* â”€â”€ CANVAS 1: VektÃ¶r UzayÄ± â”€â”€ */
const points = [
    { x:120, y:90,  label:'A love story',           color:'#7c3aed', group:'love' },
    { x:160, y:120, label:'First loves last',        color:'#7c3aed', group:'love' },
    { x:100, y:145, label:'Can two friends love?',   color:'#7c3aed', group:'love' },
    { x:430, y:70,  label:'Ninja Assassin',          color:'#ef4444', group:'action' },
    { x:460, y:110, label:'Enter a secret world',    color:'#ef4444', group:'action' },
    { x:415, y:135, label:'At the edge of the world',color:'#ef4444', group:'action' },
    { x:260, y:230, label:'A comedy from the heart', color:'#f59e0b', group:'comedy' },
    { x:310, y:250, label:'A funny true story',      color:'#f59e0b', group:'comedy' },
    { x:240, y:260, label:'Will make you laugh',     color:'#f59e0b', group:'comedy' },
];

function drawVecCanvas() {
    const c = document.getElementById('vecCanvas');
    if (!c) return;
    const ctx = c.getContext('2d');
    const W = c.width, H = c.height;
    ctx.clearRect(0,0,W,H);

    // background
    ctx.fillStyle = '#f8fafc';
    ctx.fillRect(0,0,W,H);

    // group halos
    const groups = {
        love:   { cx:130, cy:118, r:75, color:'rgba(124,58,237,0.08)', stroke:'rgba(124,58,237,0.25)', label:'AÅŸk filmleri' },
        action: { cx:435, cy:105, r:75, color:'rgba(239,68,68,0.08)',  stroke:'rgba(239,68,68,0.25)',  label:'Aksiyon filmleri' },
        comedy: { cx:270, cy:247, r:65, color:'rgba(245,158,11,0.08)', stroke:'rgba(245,158,11,0.25)', label:'Komedi filmleri' },
    };
    for (const g of Object.values(groups)) {
        ctx.beginPath();
        ctx.arc(g.cx, g.cy, g.r, 0, Math.PI*2);
        ctx.fillStyle = g.color;
        ctx.fill();
        ctx.strokeStyle = g.stroke;
        ctx.lineWidth = 2;
        ctx.setLineDash([5,4]);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = g.stroke.replace('0.25','0.7');
        ctx.font = 'bold 11px Segoe UI';
        ctx.textAlign = 'center';
        ctx.fillText(g.label, g.cx, g.cy - g.r - 8);
    }

    // question point
    const qx = 148, qy = 72;
    ctx.beginPath();
    ctx.arc(qx, qy, 10, 0, Math.PI*2);
    ctx.fillStyle = '#10b981';
    ctx.fill();
    ctx.strokeStyle = 'white'; ctx.lineWidth = 2; ctx.stroke();
    ctx.fillStyle = '#10b981'; ctx.font = 'bold 11px Segoe UI'; ctx.textAlign = 'left';
    ctx.fillText('Soru: "love movies"', qx+14, qy+4);

    // dashed lines from question to love points
    points.filter(p=>p.group==='love').forEach(p => {
        ctx.beginPath();
        ctx.moveTo(qx, qy); ctx.lineTo(p.x, p.y);
        ctx.strokeStyle = 'rgba(124,58,237,0.3)'; ctx.lineWidth=1.5;
        ctx.setLineDash([4,3]); ctx.stroke(); ctx.setLineDash([]);
    });

    // dots
    points.forEach(p => {
        ctx.beginPath();
        ctx.arc(p.x, p.y, 7, 0, Math.PI*2);
        ctx.fillStyle = p.color; ctx.fill();
        ctx.strokeStyle = 'white'; ctx.lineWidth=1.5; ctx.stroke();
    });

    // legend
    const leg = [
        {color:'#10b981', label:'Sorgu vektÃ¶rÃ¼'},
        {color:'#7c3aed', label:'Ask filmi vektÃ¶rÃ¼'},
        {color:'#ef4444', label:'Aksiyon filmi vektÃ¶rÃ¼'},
        {color:'#f59e0b', label:'Komedi filmi vektÃ¶rÃ¼'},
    ];
    leg.forEach((l,i) => {
        ctx.beginPath(); ctx.arc(20, H-80+i*18, 5, 0, Math.PI*2);
        ctx.fillStyle = l.color; ctx.fill();
        ctx.fillStyle = '#64748b'; ctx.font = '11px Segoe UI'; ctx.textAlign = 'left';
        ctx.fillText(l.label, 32, H-76+i*18);
    });
}
window.addEventListener('load', drawVecCanvas);

/* â”€â”€ CANVAS 2: Cosine â”€â”€ */
function drawCosine() {
    const c = document.getElementById('cosCanvas');
    if (!c) return;
    const ctx = c.getContext('2d');
    const W = c.width, H = c.height;
    ctx.clearRect(0,0,W,H);
    ctx.fillStyle = '#f8fafc'; ctx.fillRect(0,0,W,H);

    const cx = 120, cy = H/2;

    function drawVec(angle, len, color, label, score) {
        const ex = cx + Math.cos(angle)*len;
        const ey = cy - Math.sin(angle)*len;
        ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(ex,ey);
        ctx.strokeStyle = color; ctx.lineWidth = 3; ctx.stroke();
        // arrow
        const a = Math.atan2(cy-ey, ex-cx);
        ctx.beginPath();
        ctx.moveTo(ex,ey);
        ctx.lineTo(ex - 10*Math.cos(a-0.4), ey + 10*Math.sin(a-0.4));
        ctx.lineTo(ex - 10*Math.cos(a+0.4), ey + 10*Math.sin(a+0.4));
        ctx.closePath(); ctx.fillStyle = color; ctx.fill();
        // label
        ctx.fillStyle = color; ctx.font = 'bold 12px Segoe UI';
        const lx = cx + Math.cos(angle)*(len+18);
        const ly = cy - Math.sin(angle)*(len+18);
        ctx.textAlign = angle > Math.PI/2 ? 'right' : 'left';
        ctx.fillText(label, lx, ly);
        if (score !== undefined) {
            ctx.font = '11px Segoe UI'; ctx.fillStyle = '#64748b';
            ctx.fillText('sim = ' + score, lx, ly+16);
        }
    }

    // reference vector
    drawVec(0.35, 95, '#10b981', 'Sorgu vektoru', undefined);
    // close vector
    drawVec(0.5, 90, '#7c3aed', 'Benzer metin', 0.98);
    // medium
    drawVec(1.1, 88, '#f59e0b', 'Orta benzer', 0.71);
    // far
    drawVec(1.7, 85, '#ef4444', 'Ilgisiz metin', 0.18);

    // arc between reference and close
    ctx.beginPath();
    ctx.arc(cx, cy, 40, -0.5, -0.35);
    ctx.strokeStyle = '#7c3aed'; ctx.lineWidth=1.5; ctx.setLineDash([3,2]); ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = '#7c3aed'; ctx.font='11px Segoe UI'; ctx.textAlign='left';
    ctx.fillText('kucuk aci', cx+44, cy-44);

    // legend box on right
    const lx = 260;
    ctx.fillStyle = 'white'; ctx.strokeStyle = '#e2e8f0'; ctx.lineWidth=1;
    ctx.beginPath(); ctx.roundRect(lx, 30, 270, 140, 10); ctx.fill(); ctx.stroke();
    ctx.fillStyle = '#334155'; ctx.font='bold 12px Segoe UI'; ctx.textAlign='left';
    ctx.fillText('Kural:', lx+14, 55);
    const rules = [
        {color:'#7c3aed', t:'Kucuk aci â†’ yuksek skor (0.90+)'},
        {color:'#f59e0b', t:'Orta aci  â†’ orta skor (0.70)'},
        {color:'#ef4444', t:'Buyuk aci â†’ dusuk skor (0.18)'},
    ];
    rules.forEach((r,i) => {
        ctx.beginPath(); ctx.arc(lx+18, 76+i*28, 5, 0, Math.PI*2);
        ctx.fillStyle=r.color; ctx.fill();
        ctx.fillStyle='#334155'; ctx.font='11px Segoe UI';
        ctx.fillText(r.t, lx+30, 80+i*28);
    });
}

/* â”€â”€ SIM BARS â”€â”€ */
const simData = [
    { label:'Joe Versus the Volcano â€” "A story of love, lava..."', score:0.906, color:'#7c3aed' },
    { label:'As Good as It Gets â€” "A comedy from the heart..."',   score:0.902, color:'#7c3aed' },
    { label:'Snow Falling on Cedars â€” "First loves last."',        score:0.901, color:'#7c3aed' },
    { label:'Sleepless in Seattle â€” "What if someone..."',         score:0.895, color:'#7c3aed' },
    { label:'When Harry Met Sally â€” "Can two friends..."',         score:0.894, color:'#7c3aed' },
    { label:'Ninja Assassin â€” "Prepare to enter a secret world"',  score:0.612, color:'#ef4444' },
    { label:'Cast Away â€” "At the edge of the world..."',           score:0.598, color:'#ef4444' },
];

function animateBars() {
    const wrap = document.getElementById('simBars');
    wrap.innerHTML = simData.map(d => `
        <div class="sim-row">
            <div class="sim-label" style="font-size:0.85em;">${d.label}</div>
            <div class="sim-bar-wrap">
                <div class="sim-bar" id="bar-${d.label.slice(0,5).replace(/\s/g,'')}"
                     style="width:0%;background:${d.color};"></div>
            </div>
            <div class="sim-score" style="color:${d.color};">${d.score}</div>
        </div>
    `).join('');
    // animate
    simData.forEach((d,i) => {
        setTimeout(() => {
            const bar = document.getElementById('bar-' + d.label.slice(0,5).replace(/\s/g,''));
            if (bar) bar.style.width = (d.score * 100) + '%';
        }, i * 120);
    });
}

/* â”€â”€ QUERY FLOW â”€â”€ */
function showQueryFlow(type) {
    const el = document.getElementById('query-flow-result');
    el.style.display = 'block';
    const data = {
        love: {
            q: 'What movies are about love?',
            op: 'Op 1 (taglineEmbedding)',
            index: 'movie_tagline_embeddings',
            steps: [
                ['1', 'Soru vektÃ¶re Ã§evrildi', '[0.021, -0.008, ..., 0.015]'],
                ['2', 'movie_tagline_embeddings index\'i sorgulandÄ±', 'En benzer 5 :Movie node seÃ§ildi'],
                ['3', 'Top-5 sonuÃ§ dÃ¶ndÃ¼', 'Joe vs. Volcano (0.906), Sleepless in Seattle (0.895)...'],
                ['4', 'LLM\'e gÃ¶nderildi', 'Film baÅŸlÄ±klarÄ± + sloganlar â†’ cevap Ã¼retildi'],
            ],
            note: 'taglineEmbedding kullanÄ±ldÄ± â€” film sloganlarÄ±yla karÅŸÄ±laÅŸtÄ±rma yapÄ±ldÄ±.',
            color: '#7c3aed'
        },
        netapp: {
            q: 'What is Netapp\'s primary business?',
            op: 'Op 2 (textEmbedding)',
            index: 'form_10k_chunks',
            steps: [
                ['1', 'Soru vektÃ¶re Ã§evrildi', '[0.031, -0.012, ..., 0.008]'],
                ['2', 'form_10k_chunks index\'i sorgulandÄ±', 'En benzer 5 :Chunk node seÃ§ildi'],
                ['3', 'Top-5 chunk dÃ¶ndÃ¼', 'item1-chunk0001 (0.947), item1-chunk0003 (0.921)...'],
                ['4', 'LLM\'e gÃ¶nderildi', 'Chunk metinleri + soru â†’ cevap Ã¼retildi'],
            ],
            note: 'textEmbedding kullanÄ±ldÄ± â€” belge chunk\'larÄ±yla karÅŸÄ±laÅŸtÄ±rma yapÄ±ldÄ±.',
            color: '#0ea5e9'
        },
        apple: {
            q: 'Tell me about Apple.',
            op: 'Op 2 (textEmbedding)',
            index: 'form_10k_chunks',
            steps: [
                ['1', 'Soru vektÃ¶re Ã§evrildi', '[0.012, -0.031, ..., 0.004]'],
                ['2', 'form_10k_chunks index\'i sorgulandÄ±', 'En benzer 5 chunk seÃ§ildi'],
                ['3', 'DÃ¼ÅŸÃ¼k skorlu chunk\'lar dÃ¶ndÃ¼', 'HiÃ§biri Apple ile ilgili deÄŸil (skor < 0.65)'],
                ['4', 'LLM\'e gÃ¶nderildi', 'Ä°lgisiz chunk\'lar â†’ LLM "I don\'t know" dedi'],
            ],
            note: 'Apple bilgisi bu belgede yok â€” LLM uydurma yapmadÄ±, doÄŸru cevap verdi.',
            color: '#10b981'
        }
    };
    const d = data[type];
    el.innerHTML = `
        <div style="margin-bottom:12px;">
            <strong>Soru:</strong> <em>"${d.q}"</em><br>
            <span style="font-size:0.85em;color:var(--muted);">
                KullanÄ±lan embedding: <strong>${d.op}</strong> &nbsp;|&nbsp;
                Aranan index: <code>${d.index}</code>
            </span>
        </div>
        ${d.steps.map(([n,title,detail]) => `
            <div style="display:flex;gap:12px;margin:8px 0;align-items:flex-start;">
                <div style="background:${d.color};color:white;border-radius:50%;width:22px;height:22px;
                     display:flex;align-items:center;justify-content:center;
                     font-size:0.8em;font-weight:700;flex-shrink:0;margin-top:2px;">${n}</div>
                <div>
                    <div style="font-weight:600;font-size:0.9em;">${title}</div>
                    <div style="font-size:0.84em;color:var(--muted);">${detail}</div>
                </div>
            </div>
        `).join('')}
        <div style="background:${d.color}18;border:1px solid ${d.color}44;
             border-radius:8px;padding:10px 14px;margin-top:12px;font-size:0.86em;color:#334155;">
            <strong>Not:</strong> ${d.note}
        </div>
    `;
}
</script>
</body>
</html>
